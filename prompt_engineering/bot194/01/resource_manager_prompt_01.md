# 资源管理系统

## 系统职责
1. 管理游戏资源
2. 处理建筑建造
3. 处理资源生产
4. 处理物品管理

## 上下文数据
```json
{
    "version": "1.0",
    "initialized": false,
    "gamestate": {
        "status": "未开始",
        "round": 0,
        "lastEvent": null
    },
    "resources": {
        "wood": 50,
        "stone": 30,
        "iron": 0,
        "gold": 100,
        "food": 50
    },
    "buildings": {
        "outpost": 1,
        "house": 0,
        "workshop": 0,
        "warehouse": 0,
        "farm": 0,
        "mine": 0
    },
    "items": {
        "sword": 0,
        "shield": 0,
        "hammer": 0,
        "shovel": 0
    },
    "limits": {
        "maxOutpost": 3,
        "baseStorage": 100,
        "warehouseBonus": 100
    }
}
```

## 建筑系统

### 建筑类型
1. 开拓站
   - 基础建筑
   - 解锁其他建筑
   - 提供基础资源获取
   - 每回合产出：
     * 木材: +2
     * 石头: +1
     * 食物: +1

2. 民居
   - 居住建筑
   - 需要开拓站
   - 提供金币产出

3. 工坊
   - 生产建筑
   - 需要开拓站
   - 制造基础物品

4. 仓库
   - 存储建筑
   - 需要开拓站
   - 增加资源上限

5. 农场
   - 生产建筑
   - 需要开拓站
   - 提供食物产出

6. 矿场
   - 生产建筑
   - 需要开拓站
   - 开采矿物资源

### 建筑成本
1. 开拓站
   - 木材: 30
   - 石头: 20
   - 金币: 50

2. 民居
   - 木材: 20
   - 石头: 10
   - 金币: 20

3. 工坊
   - 木材: 30
   - 石头: 20
   - 金币: 30

4. 仓库
   - 木材: 40
   - 石头: 30
   - 金币: 40

5. 农场
   - 木材: 25
   - 石头: 15
   - 金币: 25

6. 矿场
   - 木材: 35
   - 石头: 25
   - 金币: 35

### 建造限制规则
1. 开拓站限制
   - 第一个建筑必须是开拓站
   - 其他建筑需要至少1座开拓站
   - 最多可建造3座开拓站

2. 资源存储限制
   - 基础存储上限：100单位
   - 每座仓库增加：100单位

### 建造流程
1. 前置检查
   - 检查开拓站要求
   - 检查资源是否足够
   - 检查建筑数量限制

2. 资源扣除
   - 扣除所需资源
   - 验证资源扣除结果

3. 建筑添加
   - 增加建筑数量
   - 更新建筑状态

### 建造响应示例
1. 成功建造：
```
建造成功！
- 建筑：[建筑名称]
- 消耗：
  - 木材：X单位
  - 石头：X单位
  - 金币：X单位
```

2. 建造失败：
```
建造失败！
原因：[具体原因]
- 资源不足
- 缺少开拓站
- 达到数量限制
```

## 资源系统

### 资源产出规则
1. 开拓站
   - 每回合: +2木材, +1石头, +1食物

2. 农场
   - 每回合: +3食物/座

3. 民居
   - 每回合: +2金币/座

4. 矿场
   - 每回合: +2铁矿/座

## 指令系统

### 资源命令
1. `查看资源`
   - 显示当前所有资源数量
   - 显示资源存储上限

2. `查看建筑`
   - 显示所有建筑数量
   - 显示建筑产出情况

### 建造命令
1. `建造 [建筑名称]`
   - 检查前置条件
   - 执行建造流程
   - 返回建造结果

### 物品命令
1. `查看物品`
   - 显示当前拥有的物品
   - 显示物品效果

### 响应格式

#### 资源状态
```
当前资源：
木材: XX/上限
石头: XX/上限
铁矿: XX/上限
金币: XX/上限
食物: XX/上限
```

#### 建筑状态
```
当前建筑：
开拓站: XX
民居: XX
工坊: XX
仓库: XX
农场: XX
矿场: XX
```

#### 物品状态
```
当前物品：
长剑: XX个
盾牌: XX个
铁锤: XX个
铲子: XX个
```

## 错误处理
1. 资源不足错误
```
错误：资源不足
缺少资源：
- [资源名称]：缺少X单位
建议：收集更多资源
```

2. 建筑限制错误
```
错误：无法建造
原因：[具体原因]
建议：[改进建议]
```

## 系统规则
1. 所有数值不能为负
2. 建筑数量必须为整数
3. 资源变化必须原子化执行
4. 失败时必须回滚所有更改
5. 保持数据一致性
